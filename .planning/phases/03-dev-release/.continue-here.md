---
phase: 03-dev-release
task: catalog-fix-complete
total_tasks: 5
status: in_progress
last_updated: 2026-01-20T11:00:00Z
---

<current_state>
Fixed the catalog-template.json duplicate bundle issue. All 5 catalog PRs (v4.14, v4.15, v4.16, v4.17, v4.18) have been merged successfully. Now investigating ubi8 base image updates before proceeding with dev release testing.

**Key discovery this session:** Konflux nudge PR #14184 exists for ubi8/ubi:latest update targeting release-v1.15.x (digest `00da037`), but it has failing pipeline checks. This needs investigation.
</current_state>

<completed_work>
- Fixed catalog-template duplicate bundle issue (PR #14345 merged)
  - Root cause: Both v1.15.3 and v1.15.4 entries pointed to same bundle image
  - Fix: Restored v1.15.3 image to original sha256:0ba1efe8...
- Closed failing catalog PRs (#14339, #14340, #14342, #14343, #14344)
- Closed OCP 4.12 catalog PR #14349 (EOL)
- Re-ran index-render-template workflow (3rd time)
- New catalog PRs created and ALL MERGED:
  - #14346 (v4.14) - MERGED
  - #14347 (v4.18) - MERGED
  - #14348 (v4.15) - MERGED
  - #14350 (v4.16) - MERGED
  - Note: v4.17 PR #14340 was already merged earlier
- Analyzed 1.21.x vs 1.15.x release patterns for Konflux differences
- Identified ubi8 image staleness issue (ubi8/ubi 2 months old)
</completed_work>

<remaining_work>
**Immediate:**
1. Investigate why Konflux nudge PR #14184 (ubi8 update) is failing
2. Either fix and merge #14184, or create fresh ubi8 update PR
3. Trigger component rebuilds with new ubi8 base

**After ubi8 update:**
4. Verify all index on-push builds complete
5. Copy index images to quay.io/openshift-pipeline dev registry
6. Copy component images to dev registry (this was the original Plan 03-02 blocker)
7. Test deployment on OCP 4.18 cluster
8. Generate QE handoff
</remaining_work>

<decisions_made>
- Skip OCP 4.12 catalog - it's EOL
- Root cause of duplicate bundle: index-render-template workflow updates existing bundle SHAs but doesn't add new versions. For patch releases, new versions must be added manually first.
- Discovered ubi8/ubi:latest images are 2 months stale (Nov 2025), while ubi8/ubi-minimal is current
- Found existing Konflux nudge PR #14184 for ubi8 update - prefer using this over creating new PR
</decisions_made>

<blockers>
**Current:** Konflux nudge PR #14184 (ubi8 update) has failing pipelines
- operator-1-15-operator-on-pull-request: FAIL
- operator-1-15-proxy-on-pull-request: FAIL
- operator-1-15-webhook-on-pull-request: FAIL
- Needs investigation to determine failure cause

**Potential:** Once ubi8 updated, component images will need rebuilding, which adds time before dev release can proceed.
</blockers>

<context>
**Release comparison insights (1.21.x vs 1.15.x):**
1. 1.21.x dynamically extracts BUNDLE_NAME from image; 1.15.x has it hardcoded
2. 1.21.x uses -rhel9 suffix; 1.15.x uses -rhel8 suffix
3. Registry flow: quay.io (dev) → registry.stage.redhat.io (stage) → registry.redhat.io (prod)

**UBI8 image status:**
- ubi8/ubi:latest in operator/proxy/webhook Dockerfiles: sha256:bcfca5f (Nov 2025) - STALE
- ubi8/ubi-minimal in bundle Dockerfile: sha256:b3b8ab0 (Jan 2026) - CURRENT
- Konflux nudge PR #14184 has latest: sha256:00da037

**Merged PRs this session:**
- #14345: fix(1.15.4): Restore v1.15.3 bundle image to original
- #14346, #14347, #14348, #14350: Catalog PRs for v4.14-v4.18

**Test Cluster:** OCP 4.18.30 (api.e8yd8-jboom-ft5.xazm.p3.openshiftapps.com)
</context>

<next_action>
1. Check why PR #14184 Konflux pipelines are failing:
   ```bash
   oc logs -n tekton-ecosystem-tenant <pod> --all-containers | tail -100
   ```

2. If fixable, get PR #14184 merged. If not, may need to create fresh ubi8 update PR.

3. After ubi8 merge, trigger operator/proxy/webhook rebuilds and wait for completion.

4. Then proceed with original Plan 03-02: copy images to dev registry and test deployment.
</next_action>
