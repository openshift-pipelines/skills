---
phase: 03-dev-release
task: 1
total_tasks: 7
status: ready_to_execute
last_updated: 2026-01-19T18:25:00Z
---

<current_state>
Plan 03-02 has been REWRITTEN to address the root cause of deployment failure.

**Discovery:** The bundle CSV contains OLD image digests from v1.15.3, not the new CVE-fixed Konflux builds. Simply copying images won't work because:
1. Bundle references `registry.redhat.io/openshift-pipelines/pipelines-controller-rhel8@sha256:90e3d9dd...`
2. New Konflux build has different digest: `@sha256:0d405d7b...`
3. Version string shows 1.15.3, not 1.15.4

**Solution:** Proper release workflow needed - update version to 1.15.4, rebuild bundle with new component SHAs, rebuild index.
</current_state>

<completed_work>
- Plan 03-01: Index images copied to dev registry ✅
- Plan 03-01: Deployment test revealed component image mismatch
- Plan 03-02: Original plan attempted but discovered fundamental issue
- Plan 03-02: REWRITTEN with proper release workflow (7 tasks)
- Investigation: Identified bundle has old digests, not new Konflux builds
- Investigation: Confirmed version shows 1.15.3, needs to be 1.15.4
</completed_work>

<remaining_work>
Plan 03-02 (REWRITTEN - not yet started):
- Task 1: Update operator project.yaml to 1.15.4
- Task 2: Run update-sources workflow
- Task 3: Run operator-update-images workflow (refreshes bundle with new component SHAs)
- Task 4: Run index-render-template workflow (creates fresh index images)
- Task 5: Copy all images to dev registry
- Task 6: Test deployment on cluster
- Task 7: Generate QE handoff
</remaining_work>

<decisions_made>
- Cannot simply copy Konflux images to dev registry - bundle has wrong digests
- Need to run operator-update-images workflow to refresh bundle with new component SHAs
- Version must be bumped from 1.15.3 to 1.15.4 in project.yaml
- No ImageDigestMirrorSet needed - images go directly to quay.io/openshift-pipeline
- Full release workflow required: version update → component rebuild → bundle rebuild → index rebuild
</decisions_made>

<blockers>
None currently - plan is ready to execute
</blockers>

<context>
**Test Cluster:** OCP 4.18.30 (api.e8yd8-jboom-ft5.xazm.p3.openshiftapps.com)
- CatalogSource: Created with old index
- Operator CSV: v1.15.3 (NOT 1.15.4)
- Component Pods: ImagePullBackOff (digests don't exist in quay.io/openshift-pipeline)

**Key Files:**
- Operator repo: https://github.com/openshift-pipelines/operator (branch: release-v1.15)
- project.yaml: Contains version.current that needs update to 1.15.4

**Workflows to run (in order):**
1. update-sources-release-v1.15.yaml - syncs upstream
2. operator-update-images-release-v1.15.yaml - updates bundle with fresh component SHAs
3. index-render-template - creates index PRs for each OCP version

**Bundle → Image Reference Chain:**
Index image → contains bundle → bundle CSV has relatedImages → those digests must exist in quay.io/openshift-pipeline for dev testing
</context>

<next_action>
Start with Task 1: Update operator project.yaml to 1.15.4

```bash
# Clone operator repo
WORK_DIR="/tmp/operator-1.15.4"
rm -rf "${WORK_DIR}"
git clone https://github.com/openshift-pipelines/operator -b release-v1.15 "${WORK_DIR}"
cd "${WORK_DIR}"

# Check current version
cat project.yaml | grep -A5 "version:"

# Update version.current from 1.15.3 to 1.15.4
# Create PR for the change
```

Then proceed through Tasks 2-7 sequentially - each depends on the previous completing.
</next_action>
